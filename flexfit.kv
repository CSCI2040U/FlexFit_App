#:import MDNavigationLayout kivymd.uix.navigationdrawer.MDNavigationLayout
#:import MDNavigationDrawer kivymd.uix.navigationdrawer.MDNavigationDrawer
#:import MDNavigationDrawerMenu kivymd.uix.navigationdrawer.MDNavigationDrawerMenu
#:import MDNavigationDrawerHeader kivymd.uix.navigationdrawer.MDNavigationDrawerHeader
#:import MDNavigationDrawerItem kivymd.uix.navigationdrawer.MDNavigationDrawerItem
#:import MDLabel kivymd.uix.label.MDLabel
#:import MDTopAppBar kivymd.uix.toolbar.MDTopAppBar

ScreenManager:
    SplashScreen:
    LoginScreen:
    SignUpScreen:
    UserInfoScreen:
    HomeScreen:

<SplashScreen>:
    name: "splash"
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 1, 1, 1, 1
        spacing: "20dp"
        padding: "50dp"

        Image:
            source: "assets/logo.png"
            size_hint: None, None
            size: "150dp", "150dp"
            pos_hint: {"center_x": 0.5}

        MDLabel:
            text: "FlexFit"
            font_style: "H5"
            theme_text_color: "Custom"
            text_color: 0.6, 0.4, 1, 1
            halign: "center"

        MDRaisedButton:
            text: "Get Started"
            md_bg_color: 0.6, 0.4, 1, 1
            pos_hint: {"center_x": 0.5}
            on_release: app.switch_to_login()

<LoginScreen>:
    name: "login"
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 1, 1, 1, 1
        spacing: "20dp"
        padding: "50dp"

        MDLabel:
            text: "Login"
            font_style: "H4"
            halign: "center"
            theme_text_color: "Primary"

        MDTextField:
            id: login_email
            hint_text: "Email"
            icon_right: "email"
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}

        PasswordTextField:
            id: login_password
            hint_text: "Password"
            password: True
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}
            icon_right: "eye-off"

            MDCard:
                size_hint: None, None
                size: "35dp", "35dp"
                radius: [17,]  # Rounded like a circle
                md_bg_color: 0.9, 0.9, 0.9, 1  # Light gray background
                pos_hint: {"center_x": 0.97, "center_y": 0.5}

                MDIconButton:
                    id: password_toggle
                    icon: "eye-off"
                    size_hint: None, None
                    size: "30dp", "30dp"
                    on_release: root.toggle_password_visibility()

        MDRaisedButton:
            text: "Login"
            md_bg_color: 0.6, 0.4, 1, 1
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}
            on_release: app.switch_to_home()

        MDTextButton:
            text: "Forgot Password?"
            pos_hint: {"center_x": 0.5}
            theme_text_color: "Primary"

        MDCard:
            size_hint: None, None
            size: "45dp", "45dp"  # Square shape
            elevation: 0.75  # Adds shadow for depth
            radius: [50,]  # Rounded edges like in your image
            md_bg_color: 1, 1, 1, 1  # White background
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

            MDIconButton:
                icon: "assets/google_logo.png"
                size_hint: None, None
                size: "40dp", "40dp"
                theme_icon_color: "Custom"
                icon_color: 1, 1, 1, 1  # Keeps original Google logo colors
                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                on_release: app.google_sign_in()

        MDLabel:
            text: "Don't have an account? [ref=signup][b]Sign Up[/b][/ref]"
            markup: True
            theme_text_color: "Custom"
            text_color: 0.2, 0.4, 1, 1  # Blue hyperlink color
            halign: "center"
            on_ref_press: app.switch_to_signup()



<SignUpScreen>:
    name: "signup"
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 1, 1, 1, 1
        spacing: "20dp"
        padding: "50dp"

        MDLabel:
            text: "Sign Up"
            font_style: "H4"
            halign: "center"
            theme_text_color: "Primary"

        MDTextField:
            id: signup_name
            hint_text: "Full Name"
            icon_right: "account"
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}

        MDTextField:
            id: signup_email
            hint_text: "Email"
            icon_right: "email"
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}

        PasswordTextField:
            id: signup_password
            hint_text: "Password"
            password: True
            icon_right: "eye-off"
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}

        PasswordTextField:
            id: signup_confirm_password
            hint_text: "Confirm Password"
            password: True
            icon_right: "eye-off"
            mode: "rectangle"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}

        MDRaisedButton:
            text: "Sign Up"
            md_bg_color: 0.6, 0.4, 1, 1
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}
            on_release: app.switch_to_user_info()

        MDLabel:
            text: "Already have an account? [ref=login][b]Log In[/b][/ref]"
            markup: True
            theme_text_color: "Custom"
            text_color: 0.2, 0.4, 1, 1  # Blue hyperlink color
            halign: "center"
            on_ref_press: app.switch_to_login()


<UserInfoScreen>:
    name: "user_info"
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 1, 1, 1, 1
        padding: "30dp"
        spacing: "20dp"

        MDLabel:
            text: "Hey there,"
            font_style: "H6"
            halign: "center"
            theme_text_color: "Primary"

        MDLabel:
            text: "[b]Tell Us More About You[/b]"
            markup: True
            font_style: "H5"
            halign: "center"
            theme_text_color: "Primary"

        # Birthdate Input
        MDCard:
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}
            padding: "15dp"
            radius: [15,]


            MDBoxLayout:
                orientation: "horizontal"
                spacing: "10dp"

                MDTextField:
                    id: birthdate
                    hint_text: "mm/dd/yyyy"
                    mode: "rectangle"
                    size_hint_x: 0.8
                    pos_hint: {"center_x": 0.5}
                    readonly: True  # Prevents keyboard from opening

                MDIconButton:
                    icon: "calendar"
                    pos_hint: {"center_x": 0.5}
                    on_release: app.open_date_picker()

        # Gender Selection Label
        MDBoxLayout:
            orientation: "horizontal"
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}
            spacing: "30dp"

            MDCard:
                id: male_card
                size_hint: None, None
                size: "80dp", "80dp"
                radius: [15,]
                md_bg_color: app.get_gender_color("male")
                on_release: app.select_gender("male")

                MDBoxLayout:
                    orientation: "vertical"
                    padding: "10dp"
                    spacing: "5dp"
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}

                    MDIconButton:
                        icon: "human-male"
                        pos_hint: {"center_x": 0.5}

                    MDLabel:
                        text: "Male"
                        halign: "center"
                        theme_text_color: "Secondary"

            MDCard:
                id: female_card
                size_hint: None, None
                size: "80dp", "80dp"
                radius: [15,]
                md_bg_color: app.get_gender_color("female")
                on_release: app.select_gender("female")

                MDBoxLayout:
                    orientation: "vertical"
                    padding: "10dp"
                    spacing: "5dp"
                    pos_hint: {"center_x": 0.5, "center_y": 0.5}

                    MDIconButton:
                        icon: "human-female"
                        pos_hint: {"center_x": 0.5}

                    MDLabel:
                        text: "Female"
                        halign: "center"
                        theme_text_color: "Secondary"


        # Height & Weight Input Fields
        MDTextField:
            id: height
            hint_text: "Enter Your Height (e.g. 5'10\")"
            mode: "rectangle"
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}

        MDTextField:
            id: weight
            hint_text: "Enter Your Weight (in kgs)"
            mode: "rectangle"
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}

        # Continue Button
        MDRaisedButton:
            text: "Continue"
            size_hint_x: 0.8
            pos_hint: {"center_x": 0.5}
            md_bg_color: 0.6, 0.4, 1, 1
            on_release: app.complete_user_info()

<HomeScreen>:
    name: "home"
    MDBoxLayout:
        orientation: "vertical"
        md_bg_color: 1, 1, 1, 1
        padding: "10dp"

        # Search Bar
        MDTextField:
            id: search_field
            hint_text: "Search"
            mode: "rectangle"
            icon_right: "magnify"
            size_hint_x: 0.9
            pos_hint: {"center_x": 0.5}
            height: "50dp"
            md_bg_color: 0.95, 0.92, 1, 1
            radius: [25,]

        # Scrollable Workout Categories
        ScrollView:
            MDBoxLayout:
                orientation: "vertical"
                padding: "10dp"
                spacing: "10dp"
                size_hint_y: None
                height: self.minimum_height

                # Indoor Workout Card
                MDCard:
                    size_hint_x: 0.9
                    height: "150dp"
                    radius: [15,]
                    pos_hint: {"center_x": 0.5}
                    on_release: app.open_category("Indoor")
                    FitImage:
                        source: "assets/indoor_workout.jpg"
                    MDLabel:
                        text: "INDOOR"
                        bold: True
                        halign: "center"
                        pos_hint: {"center_y": 0.5}
                        theme_text_color: "Custom"
                        text_color: 0.6, 0.4, 1, 1
                        font_size: "22sp"

                # Outdoor Workout Card
                MDCard:
                    size_hint_x: 0.9
                    height: "150dp"
                    radius: [15,]
                    pos_hint: {"center_x": 0.5}
                    on_release: app.open_category("Outdoor")
                    FitImage:
                        source: "assets/outdoor_workout.jpg"
                    MDLabel:
                        text: "OUTDOOR"
                        bold: True
                        halign: "center"
                        pos_hint: {"center_y": 0.5}
                        theme_text_color: "Custom"
                        text_color: 0.6, 0.4, 1, 1
                        font_size: "22sp"

                # Wellness Workout Card
                MDCard:
                    size_hint_x: 0.9
                    height: "150dp"
                    radius: [15,]
                    pos_hint: {"center_x": 0.5}
                    on_release: app.open_category("Wellness")
                    FitImage:
                        source: "assets/wellness_workout.jpg"
                    MDLabel:
                        text: "WELLNESS"
                        bold: True
                        halign: "center"
                        pos_hint: {"center_y": 0.5}
                        theme_text_color: "Custom"
                        text_color: 0.6, 0.4, 1, 1
                        font_size: "22sp"

        # Bottom Navigation Bar
        MDBottomNavigation:
            size_hint_y: None
            height: "60dp"
            MDBottomNavigationItem:
                name: "home"
                icon: "home"
                text: "Home"
                on_tab_press: app.switch_to_home()

            MDBottomNavigationItem:
                name: "saved"
                icon: "bookmark"
                text: "Saved"
                on_tab_press: app.switch_to_saved()

            MDBottomNavigationItem:
                name: "user"
                icon: "account"
                text: "User"
                on_tab_press: app.switch_to_user()
